<main>
  <section class="container section-header">
    <h1 class="title">Localizações de<span>Rick e Morty</span></h1>

    <picture class="picture">
      <source srcset="images/bg-locations.png" type="image/svg+xml" />
      <img src="images/bg-locations.png" alt="Imagem do Rick e Morty" />
    </picture>
  </section>

  <section class="bg-dark section-table">
    <div class="container">
      <div class="row">
        <div class="col-12 col-md-6 d-flex">
          <h2 class="text-white">Filtro de Localizações</h2>
        </div>

        <div class="col-12 col-md-6 ms-auto d-flex">
          <input
            class="form-control w-100"
            type="search"
            placeholder="Pesquisar localizações..."
            [value]="(searchTerm$ | async) ?? ''"
            (input)="onSearch($any($event.target).value)"
          />
        </div>
      </div>

      <div class="row max-w-100 overflow-auto">
        <div class="table-responsive">
          <table class="table">
            <thead class="table-dark">
              <tr>
                <th scope="col" class="th-id">#</th>
                <th scope="col" class="th-primary">Nome</th>
                <th scope="col" class="th-secondary">Dimensão</th>
                <th scope="col" class="th-actions">Ações</th>
              </tr>
            </thead>
            <tbody class="table-body">
              @for(location of locations$ | async; track location.id){
              <tr>
                <th scope="row">
                  {{ location.id }}
                </th>
                <td>
                  <div class="td-text">
                    {{ location.name }}
                  </div>
                </td>
                <td>
                  <div class="td-text">
                    {{ location.dimension }}
                  </div>
                </td>
                <td>
                  <a class="btn btn-primary btn-sm" [routerLink]="['/locations', location.id]"
                    >Detalhes</a
                  >
                </td>
              </tr>
              } @if(loading$ | async){
              <tr>
                <td colspan="4" [class.table-loading]="isFirstLoad$ | async" class="text-center">
                  Carregando...
                </td>
              </tr>
              } @else if((locations$ | async)?.length === 0){
              <tr>
                <td colspan="4" class="text-center">Nenhuma localização encontrada.</td>
              </tr>
              }
            </tbody>
          </table>
        </div>
      </div>

      <div #infiniteAnchor style="height: 1px"></div>
    </div>
  </section>
</main>
